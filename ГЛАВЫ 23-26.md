### Глава 23: СЛУЖБА ЭЛЕКТРОННОЙ ПОЧТЫ
1. **Основы службы электронной почты**
2. **Политика и пространства имен**
3. **Надежность и простота**
4. **Блокировка спама и вирусов**
5. **Универсальность и автоматизация**
6. **Базовый мониторинг и резервирование**
7. **Расширение и вопросы безопасности**
8. **Распространение информации**
9. **Тонкости**
## Основы службы электронной почты
Электронная почта является критически важной службой для бизнеса любой компании. Все ожидают, что она будет работать без сбоев. Надежная и масштабируемая система электронной почты должна строиться на прочной основе. Системный администратор, который проектирует и строит эту службу, должен сначала обеспечить надежную основу, прежде чем добавлять функции или расширять службу для работы с большими объемами трафика.
## Политика и пространства имен
**Политика неприкосновенности** должна быть в каждой компании, и она должна быть доведена до каждого сотрудника. Политика должна описывать, кто и при каких обстоятельствах может читать электронную почту пользователя. Системные администраторы должны реализовывать эту политику и убедиться, что все пользователи знают о ней.
**Пространства имен** для адресов электронной почты компании важны как для клиентов, так и для сотрудников. Стандартизация адресов, например, в формате имя.фамилия, популярна, но можно использовать уникальные именные маркеры, такие как chogan или jsmith.
## Надежность и простота
**Надежность** электронной почты критически важна, так как люди ожидают, что она будет работать всегда, как телефон или электричество. Новые системы и архитектуры должны устанавливаться только после тщательного тестирования.
**Простота** системы электронной почты снижает риск ошибок и облегчает поддержку. Следует ограничить количество машин, обеспечивающих службу, и избегать использования рабочих станций для маршрутизации почты. Простота также предполагает использование стандартных протоколов и избегание шлюзов.
## Блокировка спама и вирусов
Спам и вредоносные программы могут быть блокированы как на клиенте, так и на сервере. Блокировка на сервере более эффективна, так как проще обновить сервер, чем множество клиентов. Это также позволяет убедиться, что пользователи знают, как отключать защитные программы на своих клиентах.
## Универсальность и автоматизация
**Универсальность** системы электронной почты важна для успешного общения с максимальным количеством людей. Она должна быть основана на открытых протоколах, которые широко принимаемы и реализованы. Это также касается связи внутри компании и поддержки различных методов чтения электронной почты.
**Автоматизация** может упростить часто выполняемые задачи и обеспечить их надежное выполнение. Многие аспекты администрирования электронной почты должны быть автоматизированы, включая управление списками рассылки, чтобы пользователи могли создавать и управлять ими самостоятельно.
## Базовый мониторинг и резервирование
**Базовый мониторинг** должен включать проверку, что каждая машина, используемая для службы, подключена к сети и отвечает на запросы на соответствующие TCP-порты. Также необходимо отслеживать использование дискового пространства и загрузку процессора.
**Резервирование** важно для обеспечения надежности службы электронной почты. Стратегия резервирования должна учитывать все компоненты системы и их взаимодействие.
## Расширение и вопросы безопасности
**Расширение** системы электронной почты необходимо для работы с большими объемами трафика и большим количеством пользователей. Системы должны быть готовы к увеличению нагрузки и пикам интенсивности.
**Вопросы безопасности** важны, так как узлы передачи почты часто становятся целью для злоумышленников. Безопасность должна учитываться на всех этапах проектирования системы.
## Распространение информации
**Распространение информации** о службе электронной почты важно для пользователей и системных администраторов. Пользователи должны понимать политики, связанные с системой, такие как неприкосновенность частной информации и резервное копирование. Документация для системных администраторов также важна для поддержки системы.
## Тонкости
**Шифрование**: Введение простого в применении механизма шифрования может улучшить базовую систему электронной почты. Шифрование особенно полезно для высших руководителей, которые работают с конфиденциальной информацией. Процесс должен быть быстрым и простым, чтобы шифрование сообщения перед отправкой не занимало много времени. Шифрование должно быть интегрировано в почтовый клиент, чтобы руководители могли просто щелкнуть по кнопке "Зашифровать" при отправке, настроить автоматическое шифрование для определенных получателей или включить шифрование по умолчанию для всех сообщений. Санкционированный получатель должен иметь возможность легко расшифровать сообщение.
**Политика хранения электронной почты**: Резервные копии важны, но могут представлять риск. В некоторых компаниях есть политика отсутствия резервного копирования электронной почты или удаления таких резервных копий через короткий период времени. Политика хранения документов ограничивает время хранения и упрощает поиск нужных документов.
**Расширенный мониторинг**: Для компаний, от которых зависят доходы, желательно реализовать более развитые методы мониторинга системы электронной почты. Передача и доставка электронной почты включают сложную последовательность действий, и системные администраторы могут упустить важные детали при базовом мониторинге.
**Обработка больших списков**: В большинстве компаний есть списки рассылки, которые могут быть важны для обслуживания пользователей. Например, списки рассылки могут сообщать о новых продуктах или событиях в компании. В некоммерческих организациях списки рассылки могут информировать членов о мероприятиях.

### Глава 24: СЛУЖБА ПЕЧАТИ
1. **Основы службы печати**
2. **Уровень централизации и политика архитектуры печати**
3. **Структура системы и документация**
4. **Мониторинг и экологические вопросы**
5. **Тонкости**
## Основы службы печати
Успешная система печати начинается с понимания требований к хорошей политике и целостному проектированию. Без необходимой политики проектирование не будет иметь верного направления, а без проектирования функции печати будут нестабильными и сложными в использовании.
## Уровень централизации и политика архитектуры печати
**Уровень централизации**: Основное требование системы печати — возможность для пользователей печатать на всех разрешенных принтерах. Это может включать все принтеры или только определенные группы. Расходы могут быть постраничными или индивидуальными для каждой группы. Более многочисленные принтеры обеспечивают большее удобство, но и более высокие затраты.
**Политика архитектуры печати**: В каждой компании должны быть письменные политики, связанные с печатью. Политика определяет степень централизации печати, количество пользователей на один принтер, наличие персональных принтеров и способы подключения принтеров к сети. Также должна быть бухгалтерская политика, определяющая, как принтеры приобретаются и финансируются. Стандарт оборудования должен быть документирован, включая долговременные стандарты, такие как использование PostScript или PCL, и политику назначения имен принтерам.
## Структура системы и документация
**Структура системы**: После определения правил можно спроектировать и реализовать архитектуру системы печати. Существуют различные архитектуры, такие как пиринговая и центральный буфер. Пиринговая архитектура децентрализована и проста в создании, но может стать сложной по мере роста. Центральный буфер более централизован и предоставляет больший контроль.
**Документация**: Системные администраторы должны предоставить пользователям три типа документации: инструкцию по печати, список принтеров и метки принтеров. Инструкция должна объяснять, как подключиться к принтеру, список — описывать доступные принтеры и их особенности, а метки — указывать на расположение принтеров.
## Мониторинг и экологические вопросы
**Мониторинг**: Системные администраторы должны следить за состоянием каждой системы буферизации, чтобы избежать зависаний и перегрузок. Также необходимо отслеживать состояние каждого принтера, включая заправку картриджей и лотков для бумаги.
**Экологические вопросы**: Системные администраторы должны учитывать экологические аспекты печати. Печать может иметь негативное воздействие на окружающую среду, и важно минимизировать отходы. Картриджи должны перерабатываться, а использование химических веществ должно быть контролируемым.
## Тонкости
**Автоматическое восстановление после отказа и балансировка нагрузки**: Системные администраторы могут создать системы автоматического восстановления после отказа, чтобы снизить время простоя, связанное с проблемами с принтерами. Если служба печати работает с большими объемами, системные администраторы должны обеспечить использование резервных систем для балансировки нагрузки. Например, может быть две системы буферизации печати, каждая из которых обслуживает половину принтеров для балансировки нагрузки и заменяет другую в случае сбоя для минимизации времени простоя.
**Выделенный сотрудник для обслуживания**: Принтеры — это механические устройства, и их надежность можно повысить, исключив их обслуживание необученными людьми. Мы не хотим недооценить технические способности наших пользователей, но видели, как умные люди ломали принтеры, пытаясь сменить картридж.
**Уничтожение бумаги**: Хорошо бы уничтожать все, что вы не хотите видеть на первой полосе New York Times. Если что-то не напечатать — это будет даже безопаснее, чем уничтожение.

### Глава 25: ХРАНЕНИЕ ДАННЫХ
1. **Основы хранения данных**
2. **Ключевые термины в управлении хранилищем**
3. **Управление хранилищем**
4. **Тонкости**
### Основы хранения данных
Эффективное управление хранением данных является важной задачей, аналогично другим службам в организации. Это включает в себя обеспечение производительности, диагностику проблем и оценку новых технологий, что должно быть частью работы команды, занимающейся системами хранения. Хранение данных должно быть организовано так, чтобы соответствовать потребностям бизнеса и обеспечивать надежность и доступность информации.
### Ключевые термины в управлении хранилищем
В управлении хранилищем используются несколько ключевых терминов и концепций:
- **Основные компоненты дисков**: Жесткий диск состоит из нескольких пластин, на которых записываются данные. Эти пластины крепятся на одном шпинделе и вращаются вместе, а данные записываются на дорожках, представляющих собой окружности с центром на шпинделе. Контроллер диска — это электронная часть, реализующая протоколы, такие как SCSI или ATA. Адаптер главной шины (HBA) управляет коммуникацией между дисками и сервером.
- **RAID (избыточный массив независимых дисков)**: RAID объединяет несколько жестких дисков для создания более надежного и производительного хранилища. Существует несколько уровней RAID, включая:
  - **RAID 0**: Данные распределяются по нескольким дискам для создания одного большого логического диска.
  - **RAID 1**: Данные дублируются на двух или более дисках для повышения надежности.
  - **RAID 5**: Использует распределение данных с контролем четности для обеспечения надежности при меньших затратах.
  - **RAID 10**: Сочетает RAID 0 и RAID 1 для увеличения производительности и надежности.
- **Типы хранилищ**:
  - **DAS (Directly Attached Storage)**: Прямое подключение жесткого диска к серверу.
  - **NAS (Network-Attached Storage)**: Система хранения, подключенная к сети, позволяющая клиентам получать доступ к данным через сетевые протоколы.
  - **SAN (Storage Area Network)**: Выделенная сеть для подключения серверов и систем хранения с высокой производительностью.
### Управление хранилищем
Управление хранилищем требует комплексного подхода, включающего процессы и технологии, а также активное сотрудничество с пользователями. 
Первый этап управления хранением — это анализ потребностей пользователей и подразделений. Важно учитывать не только текущее использование ресурсов, но и предстоящие изменения или события, которые могут повлиять на требования к хранению. После сбора информации о потребностях пользователей необходимо отразить эти группы в инфраструктуре хранения данных, группируя пользователей по схожим требованиям или рабочим процессам.
Также следует разработать политику управления запасными частями для систем хранения данных, чтобы избежать конфликтов между пользователями при распределении ресурсов. Необходимо заранее планировать потребности в хранении данных, чтобы избежать дефицита пространства или ресурсов в будущем.
Создание стандартов для оборудования и программного обеспечения поможет избежать проблем с совместимостью и поддержкой нестандартных решений. Эффективное управление хранением данных требует внимательного подхода к оценке потребностей пользователей, установлению четких стандартов и разработке стратегий для обеспечения надежности и производительности систем хранения данных.
### Тонкости
Централизация и децентрализация могут потребовать серьезной перестройки. Если вы просите людей потерпеть временные неудобства из-за перехода на новую систему, то должны предлагать систему, которая не только дешевле, но и лучше для них. Оптимизация использования RAID по приложениям может значительно улучшить производительность. Распределение данных в современных системах RAID осуществляется на уровне блоков, и выравнивание размера блока данных с размером блока, используемым в приложении, может повысить быстродействие. Это особенно важно для хранения баз данных и серверов приложений, таких как веб-серверы, которые обрабатывают данные с четко определенным максимальным размером пакета.
Настройка распределения данных должна учитывать операции контроля четности и размер массива. Например, приложению, использующему блоки размером 32 Кб, будет хорошо соответствовать размер блока распределения в 8 Кб в массиве из пяти дисков RAID 5. Это позволяет достичь оптимальной производительности. Однако не всем приложениям потребуется такой уровень настройки, но полезно знать, что такие приемы существуют.
При планировании инфраструктуры хранения важно учитывать, что выделение серверов хранения конкретным приложениям может обеспечить оптимальную производительность. Хотя может быть заманчиво купить самый большой жесткий диск на рынке, два диска меньшего размера могут обеспечить лучшее быстродействие. Это особенно важно учитывать, когда принимаются во внимание дополнительные требования к питанию, месту в корпусе и охлаждению.

### Глава 26: РЕЗЕРВНОЕ КОПИРОВАНИЕ И ВОССТАНОВЛЕНИЕ
1. **Основы резервного копирования и восстановления**
2. **Причины и типы восстановления**
3. **Корпоративные инструкции и SLA**
4. **График резервного копирования**
5. **Тонкости**
### Основы резервного копирования и восстановления
Возможность восстановить потерянные данные — критический элемент любой системы. Данные теряются по различным причинам: оборудование ломается, люди удаляют файлы по ошибке или умышленно, а также могут быть конфискованы судебными органами. Акционеры требуют уверенности, что природные или другие катастрофы не уничтожат их вложения. Резервное копирование аналогично страховке: вы платите за него, хотя и надеетесь, что оно никогда вам не понадобится. На самом деле оно вам нужно.
### Причины и типы восстановления
Создание системы резервного копирования и восстановления должно начинаться с определения желаемого конечного результата и соответствующих действий для достижения этого результата. Восстановление требуется по разным причинам, и причины, актуальные для вашей среды, влияют на дальнейшие решения, такие как создание политики и графика.

- **Случайное удаление файлов**: Пользователь случайно удаляет файлы, и ему требуется их восстановить. В офисной среде обычно можно ожидать возможности восстановить файл таким, каким он был один день назад, а для выполнения восстановления потребуется 3–5 часов. В финансовой сфере и электронной коммерции требования выше.

- **Сбои дисков**: Жесткий диск может сломаться, и все данные нужно восстановить. В критических системах, таких как электронная коммерция и финансовая сфера, необходимо использовать RAID, чтобы поломки дисков не влияли на обслуживание.

- **Просмотр архивных данных**: Корпоративные политики могут требовать воспроизведения всей среды в том виде, в котором она была квартал, полгода или год назад, в случае аварий или судебных процессов. Архивы — это полные резервные копии, которые обычно хранятся вне офиса и дольше других.
### Корпоративные инструкции и SLA
Организациям требуется общий документ, определяющий требования к системам восстановления данных. Создатели корпоративных политик должны установить минимум, основанный на правовых требованиях. В инструкции должны быть указаны вопросы, которые нужно учесть в каждой системе. SLA — это письменный документ, который указывает, какое обслуживание и с каким быстродействием обязуется предоставить поставщик услуг. Политика должна создаваться в диалоге с пользователями и включать три типа восстановления, желаемое время восстановления, степень подробности и время хранения резервных копий.
### График резервного копирования
Вам может понадобиться решить, с какой периодичностью запускать полное резервное копирование. В некоторых случаях требуется ежемесячное создание полных резервных копий. Частое выполнение полного резервного копирования экономит ленту, но должно соответствовать требованиям политики.
### Тонкости
Централизация и децентрализация могут потребовать серьезной перестройки. Если вы просите людей потерпеть временные неудобства из-за перехода на новую систему, то должны предлагать систему, которая не только дешевле, но и лучше для них. Оптимизация использования RAID по приложениям может значительно улучшить производительность. Распределение данных в современных системах RAID осуществляется на уровне блоков, и выравнивание размера блока данных с размером блока, используемым в приложении, может повысить быстродействие. Это особенно важно для хранения баз данных и серверов приложений, таких как веб-серверы, которые обрабатывают данные с четко определенным максимальным размером пакета.
Настройка распределения данных должна учитывать операции контроля четности и размер массива. Например, приложению, использующему блоки размером 32 Кб, будет хорошо соответствовать размер блока распределения в 8 Кб в массиве из пяти дисков RAID 5. Это позволяет достичь оптимальной производительности. Однако не всем приложениям потребуется такой уровень настройки, но полезно знать, что такие приемы существуют.
При планировании инфраструктуры хранения важно учитывать, что выделение серверов хранения конкретным приложениям может обеспечить оптимальную производительность. Хотя может быть заманчиво купить самый большой жесткий диск на рынке, два диска меньшего размера могут обеспечить лучшее быстродействие. Это особенно важно учитывать, когда принимаются во внимание дополнительные требования к питанию, месту в корпусе и охлаждению.
### Планирование времени и емкости
Восстановление и резервное копирование ограничено по времени. Восстановление должно происходить в пределах времени, разрешенного SLA службы, которая может быть отключена до завершения восстановления. Резервное копирование может выполняться только в течение определенных временных интервалов. Большинство систем значительно замедляются при выполнении резервного копирования. Скорость резервного копирования ограничена самым медленным из следующих факторов: скоростью чтения с диска, скоростью записи на резервный носитель, полосой пропускания и задержкой сети между диском и резервным носителем. Время восстановления определяется факторами, обратными упомянутым. Устройства ввода-вывода на магнитную ленту обычно записывают на нее с гораздо меньшей скоростью, чем читают. Для смягчения влияния проблем быстродействия во время резервного копирования распространено использование диска в качестве буфера. Раньше системы выполняли резервное копирование данных, копируя их с одного сервера на устройство записи на ленту централизованного узла резервного копирования. Теперь в узле резервного копирования часто размещают много дисков.
### Планирование расходных материалов
Ваши политика и график влияют на скорость использования расходных материалов: лент, чистящих лент и т. д. Это также требует выполнения расчетов. Если снова использовать политику из нашего примера, инкрементальные резервные копии могут перезаписываться после полугода хранения, а полные, помимо тех, которые хранятся отдельно в качестве архивов, можно перезаписывать через три года.
### Вопросы процесса восстановления
Важные вопросы, связанные с процессом восстановления, требуют серьезного разбора и планирования. Во-первых, нужно сформировать ожидания пользователей. Они должны знать, какова политика резервного копирования и как запросить восстановление файла. Несмотря на то что такой тип атаки может показаться редким, риск ее совершения возрастает по мере передачи более широких полномочий контроля сторонним исполнителям. В небольшой компании может быть нормальным, если руководитель просит восстановить файлы из директории сотрудника, и системный администратор может проверить, являются ли правомерными отношения персонала и руководителя, поскольку все друг друга знают.
### Автоматизация резервного копирования
Отсутствие автоматизации резервного копирования опасно и глупо. Оно опасно потому, что чем больше вы автоматизируете, тем надежнее вы исключаете фактор человеческой ошибки. Резервное копирование утомительно, и, если оно не автоматизировано, оно не будет надежно выполняться. Не везде нужна такая развитая автоматизация, но везде необходимо иметь по крайней мере два первых уровня автоматизации. Все это может казаться очевидным, но в каждой компании есть одна-две машины, на которых резервное копирование выполняется вручную. Часто они находятся за пределами брандмауэра и недостижимы из центральной системы резервного копирования. Очень важно ввести для этих систем по крайней мере простую, примитивную автоматизацию. Если что-то не автоматизировано, оно не будет выполняться. Мы без колебаний называем отсутствие автоматизации резервного копирования глупым, потому что ручное резервное копирование — это пустая трата сил и времени.
### Централизация
Другая фундаментальная задача по созданию современной системы резервного копирования — это централизация. Резервное копирование должно быть централизованным, потому что оно дорого и важно. Правильные вложения могут распределить стоимость системы резервного копирования и восстановления по многим системам. За счет централизации можно сократить два основных типа расходов. Замена ленты является дорогостоящей, потому что это трудоемкая работа. Само оборудование стоит дорого, потому что содержит прецизионные механические элементы, вращающиеся на высоких скоростях. Допустимость ошибки низкая. Без централизации привод для ленты должен подключаться к каждой машине, которой требуется резервное копирование, а иногда нужно оплачивать обход каждой машины для замены лент. В результате получается оплата большого количества дорогого оборудования и физической работы.
### Пробное восстановление
Единственное время, когда вы можете проверить качество носителей для резервного копирования, — это когда вы выполняете восстановление. Обычно это наихудшее время, чтобы узнать о проблемах. Вы сможете лучше оценить свою систему резервного копирования, если периодически будете проводить пробное восстановление. Выберите случайный файл и восстановите его с ленты, чтобы проверить, как работает этот процесс.
### Резервные носители и внешнее хранение
Ленты с резервными копиями должны храниться в безопасном месте. Бессмысленно тратить много времени и денег на системы безопасности для защиты своих данных и при этом хранить ленты с резервными копиями в незапертой комнате или шкафу. Ваши резервные копии — это драгоценности вашей компании. В современных тесных офисных зданиях может быть трудно найти безопасное и удобное пространство для их хранения. Однако для этого достаточно нескольких надежно запираемых шкафов или большого сейфа в небезопасной комнате. Если ваши резервные копии нужно оградить от риска стихийного бедствия, они не должны храниться в серверной или в комнате, которая будет затоплена, если в вашем информационном центре прорвет трубу.
### Базы данных высокой доступности
Некоторые приложения, такие как базы данных, имеют особые требования к успешности резервного копирования. База данных управляет своим пространством и оптимизирует его под конкретные типы доступа к ее сложным наборам таблиц данных. Из-за того что размещение и методы доступа к данным обычно недоступны программам резервного копирования, база данных записывается на ленту как единый блок, или файл. Если данные в этом файле изменяются при записи, информация может быть потеряна или повреждена, так как записи о размещении данных на ленте с резервной копией могут отсутствовать либо быть неправильными. Базы данных часто требуется закрывать для обеспечения целостности, чтобы во время резервного копирования не происходило транзакций.
### Изменения технологий
Только одно в системах резервного копирования и восстановления постоянно: технологии дисков и лент попеременно опережают друг друга, и всегда с разным темпом. Смиритесь с этим и не пытайтесь противостоять. В какие-то годы вперед вырвется технология хранения на лентах и вы будете считать, что сможете сделать резервную копию чего угодно. В следующие несколько лет вы увидите, что впереди идет технология хранения на дисках, и вы будете сомневаться, сможете ли вообще сделать резервные копии всех ваших данных. Чтобы понять, почему это происходит, рассмотрим исторические тенденции развития каждой технологии. Размер диска растет понемногу. Каждые несколько месяцев появляются чуть большие по объему диски. Общий объем диска удваивается каждые 15–18 месяцев, и так исторически складывается, что приложения довольно быстро находят применение всему доступному пространству. Это означает, что примерно каждый следующий год вы будете выполнять резервное копирование дисков, содержащих вдвое больше данных.
