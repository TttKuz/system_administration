### Глава 19: ИЗМЕНЕНИЕ СЛУЖБ
1. **Основы изменения служб**
2. **Минимизация вмешательства и планирование**
3. **Распространение информации и обучение**
4. **Градиентный переход и мгновенные изменения**
5. **План отмены и управление рисками**
6. **Тонкости изменения служб**
## Основы изменения служб
Изменение служб может быть необходимо по нескольким причинам: отсутствие возможностей расширения существующей системы, прекращение поддержки разработчиком или слияние компаний, требующее интеграции служб. Ваша цель — обеспечить плавный и незаметный для пользователей переход.
## Минимизация вмешательства и планирование
Для снижения рисков и заметности проблем важно медленно распространять изменения, начиная с системных администраторов и постепенно переходя к пользователям. Распространение информации играет ключевую роль в успешном переходе. Важно убедиться, что пользователи знают о происходящем и могут выразить свои заботы и временные ограничения.
Проектирование системы безопасности должно быть основано на простоте и минимализме, чтобы избежать ошибок и уязвимостей. Каждый этап перехода должен быть тщательно спланирован заранее, чтобы минимизировать влияние на пользователей.
## Распространение информации и обучение
Информирование пользователей о плане перехода важно, несмотря на стремление к незаметности. Вы должны учитывать важные сроки и моменты, когда система должна быть стабильной. Обучение пользователей также необходимо, если их работа изменится, независимо от того, насколько значительными будут изменения.
## Градиентный переход и мгновенные изменения
При планировании изменения важно учитывать влияние на пользователей. Стремитесь к минимальному вмешательству, избегая прерывания обслуживания и изменения рабочих процессов. Горизонтальный и вертикальный подходы к переходу имеют свои преимущества. Горизонтальный подход предполагает выполнение одной задачи для всех пользователей, а вертикальный — выполнение всех задач для одного пользователя.
Мгновенные изменения следует избегать, если возможно, и сначала протестировать на небольшой группе пользователей. Это может потребовать выделения дополнительных ресурсов, но обеспечит более плавный переход. В некоторых случаях мгновенное изменение неизбежно, например, при переходе на новый сервер корпоративного календаря.
## План отмены и управление рисками
План отмены важен для управления рисками при переходе. Если новая служба не работает, пользователи могут остаться без необходимых инструментов, что повлияет на их производительность. План отмены должен быть готов к быстрому выполнению, если переход не удается. Основная трудность — определить, когда его применять, так как техники могут обещать, что все заработает после «еще одного изменения», но руководство может настаивать на отмене.
## Тонкости изменения служб
**Мгновенный откат**: Важно иметь возможность быстро вернуть систему к известному рабочему состоянию при обнаружении проблемы. Это минимизирует нарушения работы пользователей. Если изменение включает обновление программы, старая версия должна оставаться на сервере для быстрого откатного действия.
**Снижение количества изменений**: Хорошее планирование может уменьшить необходимость обновлений. Например, обновления могут быть не нужны, если система уже имеет достаточную емкость. Используйте стандартные протоколы для связи, чтобы избежать трудоемких изменений конфигураций пользователей.
**Изменения веб-служб**: Обновление сервера редко требует обновления клиентского программного обеспечения, так как веб-службы работают с любым браузером. Служба должна «мягко» снижать функциональность при использовании неподдерживаемого браузера, но не отказываться от работы вовсе.
**Поддержка разработчиков**: При масштабных изменениях важно иметь поддержку разработчика. Свяжитесь с разработчиком для выявления возможных препятствий. Хорошие отношения с разработчиком могут помочь в планировании и обеспечении достаточного количества специалистов в день перехода.

### Глава 20: ТЕХНИЧЕСКИЕ ПЕРЕРЫВЫ
1. **Основы технических перерывов**
2. **Планирование и координация**
3. **Руководство и управление**
4. **Управление предложениями изменений**
5. **Разработка общего плана**
6. **Отключение доступа**
7. **Обеспечение механизмов и координации**
8. **Общение после обслуживания**
9. **Тонкости**
## Основы технических перерывов
Технические перерывы часто назначаются еженедельно, чтобы свести все рискованные изменения в один интервал, когда пользователи будут затронуты минимально. Это может быть необходимо из-за мероприятий технического характера, таких как строительные работы, модернизация системы электропитания или охлаждения, либо перемещение офиса. Системные администраторы предпочитают технические перерывы, так как они позволяют отключить все системы и службы, что упрощает обслуживание и тестирование.
## Планирование и координация
При планировании периодических технических перерывов важно работать с остальной компанией для координации дат. Важно избегать дней в конце месяца, квартала и финансового года, чтобы не мешать продажам и бухгалтерии. Если вы участвуете в создании новой компании, сделайте регулярные технические перерывы частью корпоративной культуры.
## Руководство и управление
Руководитель полета отвечает за создание объявлений, их своевременную рассылку, планирование графика выполнения задач на основе взаимного влияния требований и необходимого персонала, принятие решений о любых отключениях, мониторинг выполнения задач и сообщение о состоянии дел остальной части компании в конце перерыва. Руководитель полета не должен выполнять техническую работу во время перерыва и обычно является частью команды, где другие сотрудники выполняют его обязанности.
## Управление предложениями изменений
Все предложения изменений должны быть поданы за неделю до технического перерыва. Управление этим процессом можно осуществлять через сеть в области с контролем версий, где каждый системный администратор редактирует документы в своей директории. За неделю до изменения эта область блокируется, и все последующие запросы на изменения должны делаться через руководителя полета.
## Разработка общего плана
За неделю до технического перерыва руководитель полета блокирует предложения изменений и начинает работать над общим планом, учитывающим все условия, выделенное время и время работы из предложений изменений. В результате получается набор таблиц, по одной на человека, которые показывают, какую задачу должен выполнить человек и в какое время, а также определяют координатора для этой задачи. Если предложений изменений слишком много, руководитель полета может обнаружить, что их планирование по времени вызывает недопустимое количество конфликтов в плане либо доступности машин, либо необходимого персонала. Вам потребуется запас в графике на случай, если дела пойдут не так.
## Отключение доступа
Самая первая задача в ходе технического перерыва — отключить или предотвратить доступ к системе и предоставить оповещение о том, что идет технический перерыв. В зависимости от характера компании и доступных средств данный процесс может включать различные меры. Эти меры снижают возможность того, что люди будут пытаться пользоваться системами во время технического перерыва, что может вызвать нарушение целостности, порчу или потерю данных.
## Обеспечение механизмов и координации
**Последовательность отключения/загрузки**: В большинстве компаний некоторые системы должны быть доступны другим для нормального отключения или загрузки. Машина, которая пытается загрузиться без доступа к необходимым системам, не сможет нормально работать. Наиболее важные системы, такие как серверы аутентификации и серверы данных, обычно загружаются до вычислительных серверов и рабочих станций.
**КВМ и служба консоли**: Коммутаторы КВМ и последовательные консольные серверы облегчают управление, предоставляя возможность удаленного доступа к консоли машины.
**Радиостанции**: Из-за плотного графика технического перерыва и большого количества взаимосвязей радиостанции могут быть полезны для связи между системными администраторами.
**Предельные сроки завершения изменения**: Руководитель полета должен отслеживать ход выполнения задач и решать, когда прервать выполнение задачи и перейти к плану отмены.
**Полное тестирование системы**: Завершающий этап технического перерыва — это полное тестирование системы. Это помогает обнаружить проблемы до того, как пользователи начнут работу.
**Общение после обслуживания**: После завершения работ по техобслуживанию и тестированию системы руководитель полета рассылает сообщение, информируя всех о восстановлении службы.
**Возобновление удаленного доступа**: Последним действием перед уходом из здания должно быть возобновление удаленного доступа и восстановление сообщения на автоответчике телефона службы поддержки.
**Обсуждение итогов**: После технического перерыва руководитель полета и старшие системные администраторы обсуждают, что прошло не так и что можно изменить.

## Тонкости
**Обучение нового руководителя полета**: Для дальнейших технических перерывов может быть полезно обучать новых руководителей полета. Это позволяет выбирать их заблаговременно, чтобы они могли работать с нынешним руководителем. В качестве альтернативы руководитель полета может создать первый черновой вариант вместе с обучаемым, объясняя процесс по ходу.
**Анализ тенденций в данных истории**: Полезно отслеживать время выполнения задач и анализировать данные для улучшения оценок в процессе распределения задач и планирования. Например, если перемещение данных заняло 8 часов, вы сможете более точно предсказать время для аналогичных задач в будущем. Анализ тенденций особенно полезен при рассмотрении данных истории, что позволяет новым сотрудникам ознакомиться с типами задач и их продолжительностью.
**Предоставление ограниченной доступности**: Возможно, вас попросят поддерживать доступность службы для определенной группы во время технического перерыва. Это может быть связано с непредвиденными обстоятельствами, такими как ошибка, над которой инженеры работают все выходные, или с новым графиком работы подразделения, требующим постоянного доступа к системам. Чтобы начать выполнение этой задачи, выясните, каким пользователям потребуется возможность работы во время технического перерыва. Используйте свое знание систем для занесения этих потребностей в список требований доступности служб. Например, пользователям почти наверняка понадобятся службы имен и аутентификации.

### Глава 21: ЦЕНТРАЛИЗАЦИЯ И ДЕЦЕНТРАЛИЗАЦИЯ
1. **Основы централизации и децентрализации**
2. **Руководящие принципы**
3. **Кандидатуры для централизации и децентрализации**
4. **Тонкости**
## Основы централизации и децентрализации
Централизация и децентрализация — это подходы к управлению системами, которые помогают системным администраторам решить, какая степень контроля подходит для конкретной компании или службы. Централизация предполагает наличие одной точки управления, например, когда все DNS-серверы в компании контролируются единым объектом. Децентрализация распределяет контроль по нескольким элементам, что может повысить скорость и гибкость за счет усиления локального контроля и обслуживания.
## Руководящие принципы
При решении вопросов централизации и децентрализации важно учитывать несколько принципов:
- **Решение проблем**: Ясно представляйте, какую проблему вы пытаетесь решить.
- **Мотивация**: Понимайте, почему вы хотите внести изменения.
- **Опыт**: Полагайтесь на здравый смысл и опыт, а не только на научные оценки.
- **Участие**: Прислушивайтесь к просьбам пользователей и консультируйтесь с ними.
- **Реализм**: Избегайте нереальных обещаний.
- **Баланс**: Централизуйте настолько, насколько это имеет смысл, и смотрите в будущее.
- **Доступ**: Чем больше что-то централизовано, тем выше вероятность, что некоторым пользователям потребуются специальные функции.
- **Отсутствие давления**: Подобно распространению любой новой службы.
- **110%**: У вас есть только один шанс произвести хорошее первое впечатление.
- **Право вето**: Слушайте пользователей, но помните о решениях руководства.
## Кандидатуры для централизации и децентрализации
**Централизация** может быть полезна для:
- **Распределенных систем**: Управление распределенными системами, например, веб-серверами.
- **Консолидация**: Объединение служб на меньшем количестве узлов.
- **Администрирование**: Системное администрирование для снижения издержек и повышения скорости.
- **Специализация**: Компетентность в определенных областях.
- **Массовость**: Централизация того, что стало массовым.
**Децентрализация** может быть полезна для:
- **Устойчивости к отказам**: Дублирование работы для устранения единичных точек отказа.
- **Индивидуализация**: Поддержка прогрессивных технологий для определенных групп пользователей.
- **Удовлетворение потребностей пользователей**: Когда централизованная группа не может выполнить требования подразделений.
## Тонкости
Централизация и децентрализация могут потребовать серьезной перестройки. Если вы просите людей терпеть временные неудобства из-за перехода на новую систему, предлагайте систему, которая не только дешевле, но и лучше для них.
- **Объединение закупок**: Централизация может привести к более быстрой доставке лучших продуктов за меньшие деньги.
- **Аутсорсинг**: Часто является формой централизации, когда сторонние компании предоставляют технические услуги.

### Глава 22: МОНИТОРИНГ СЛУЖБ
1. **Основы мониторинга служб**
2. **Исторический и реальный мониторинг**
3. **Протоколы и механизмы оповещения**
4. **Активный мониторинг и передача на более высокий уровень**
5. **Тонкости**
## Основы мониторинга служб
Мониторинг является важным компонентом обеспечения надежного и профессионального обслуживания. Он включает в себя два основных типа: мониторинг в реальном времени и исторический мониторинг. Каждый из них выполняет свою роль в обеспечении стабильности и эффективности работы систем.
## Исторический и реальный мониторинг
**Исторический мониторинг** используется для записи статистических данных о долговременной работе, использовании и производительности систем. Он включает в себя сбор данных и их просмотр, что позволяет анализировать производительность и выявлять проблемы, которые могли возникнуть в прошлом. Исторические данные помогают системным администраторам решать, нужно ли модернизировать сеть или добавить ресурсы.
**Мониторинг в реальном времени** предупреждает о сбоях сразу же, как только они происходят. Он включает в себя мониторинг, который обнаруживает сбои, и предупреждение, которое оповещает о них. Система должна наблюдать за всем, что может быть признаком проблемы, и иметь возможность опрашивать состояние систем и приложений.
## Протоколы и механизмы оповещения
**SNMP (Simple Network Management Protocol)** — это протокол, который используется для управления сетевыми устройствами. Он позволяет отправлять запросы на устройства, такие как маршрутизаторы, и получать ответы о состоянии интерфейсов. Несмотря на свою сложность, SNMP остается важным инструментом для мониторинга сетевых устройств.
**Механизм оповещения** в системе мониторинга сообщает о сбоях и требует участия человека. Он должен быть независимым от компонентов, которые находятся под наблюдением, чтобы избежать ситуаций, когда ошибка не может быть сообщена. Политика обработки сообщений должна быть четко описана.
## Активный мониторинг и передача на более высокий уровень
**Активный мониторинг** обрабатывает проблемы, которые он обнаруживает, и может устранять их автоматически. Например, он может сбросить порт модема или отключить модем от пула, если проблема не решается сбросом. Однако активный мониторинг имеет ограничения и не может устранить коренные причины проблем.
**Политика передачи на более высокий уровень** обеспечивает, что проблемы будут переданы другому человеку, если первоначальный получатель предупреждения не может ответить. Это важно для обеспечения непрерывности обслуживания и решения проблем.
## Тонкости
**Доступность**: Обычно система мониторинга устанавливается одним или двумя системными администраторами, которые разбираются с каждой ее деталью. Обеспечение доступности системы мониторинга требует хорошей документации. Некоторые формы мониторинга могут потребовать поиска информации, которая обычно не используется при ежедневном администрировании, например, SNMP MIB для компонента системы.
**Тотальный мониторинг**: В идеале хорошо иметь возможность наблюдать за всем или, по крайней мере, за всем вне рабочих станций. Это особенно важно для компаний, которые требуют очень высокой доступности, например, для сайтов электронной коммерции. Чтобы мониторинг вашей службы был тотальным, он должен быть введен в процесс установки.
**Обнаружение устройств**: Система мониторинга, которая обнаруживает подключение новых устройств к сети, может быть полезна для тотального мониторинга. Это позволяет обнаруживать любые устройства, которые остались незамеченными и не были внесены в число объектов системы мониторинга.
**Сквозное тестирование**: Сквозное тестирование означает тестирование транзакций целиком, когда система мониторинга действует как пользователь службы и проверяет, что вся транзакция успешно завершена. Оно может быть простым, например, отправка сообщения электронной почты через почтовый сервер, или сложным, имитирующим все шаги, которые делает пользователь.
**Мониторинг времени ответа приложений**: Мониторинг времени ответа приложений может быть полезен как в корпоративной среде, так и в сфере электронной коммерции. Каждый компонент системы может работать, но если система будет слишком медленной, это может привести к потере бизнеса.
**Расширение**: Когда вы начнете наблюдать за некоторыми объектами и увидите, насколько полезен мониторинг, вы захотите наблюдать за большим количеством аспектов работы своей компании. Повышение количества наблюдаемых объектов создает проблемы расширения. У всех систем мониторинга возникают проблемы при расширении. Простой сбор всех данных, которые нужно проверять каждые 5 минут, требует больших затрат времени.
**Метамониторинг**: Метамониторинг — это мониторинг вашей системы мониторинга, чтобы убедиться, что она не отказала. Если вы не получали предупреждений в течение трех дней, это может означать, что все хорошо, или кто-то отключил машину, которая обрабатывает предупреждения. Исторический метамониторинг может фиксировать, как система отвечает на растущее число запросов.
